<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>AI Prompt Generator for Web Forms</title>
<style>
  :root{--bg:#f6f7f9;--card:#fff;--accent:#007aff;--muted:#666;}
  *{box-sizing:border-box}
  body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;margin:18px;background:var(--bg);color:#111}
  main{max-width:980px;margin:0 auto;background:var(--card);padding:18px;border-radius:10px;box-shadow:0 8px 28px rgba(0,0,0,0.06)}
  h1{margin-top:0;font-size:1.25rem}
  h2{font-size:1rem;border-bottom:1px solid #eee;padding-bottom:6px;}
  .section{background:#fbfbfd;border:1px solid #eee;padding:12px;border-radius:8px;margin:12px 0}
  .form-section{background:#fffefc;border:1px dashed #cfcfcf;padding:12px;border-radius:8px;margin:12px 0}
  label{display:block;margin:8px 0;font-size:0.95rem}
  input[type=text],input[type=email],input[type=number],input[type=tel],select,textarea{
    width:100%;padding:8px;border-radius:8px;border:1px solid #ddd;margin-top:6px;font-size:1rem;
  }
  .row{display:flex;gap:12px;flex-wrap:wrap;margin:8px 0}
  .row > label{flex:1;min-width:150px;}
  .muted{color:var(--muted);font-size:0.85rem}
  button{background:var(--accent);color:#fff;border:0;padding:10px 14px;border-radius:8px;cursor:pointer}
  button.secondary{background:#999}
  .field-group{border:1px dashed #ccc;padding:8px;margin:8px 0;border-radius:6px;position:relative;}
  .field-group-remove{position:absolute;top:4px;right:4px;font-size:0.7rem;background:red;color:#fff;border:none;padding:2px 6px;border-radius:4px;cursor:pointer;}
  textarea#promptOutput{width:100%;height:400px;border:1px solid #ddd;border-radius:8px;padding:12px;margin-top:12px;white-space:pre-wrap;}
  .small-muted{font-size:0.85rem;color:#666;margin-top:6px;}
  hr{border:0;border-top:1px solid #eee;margin:12px 0;}
  /* Responsive */
  @media (max-width: 600px) {
    body {margin: 12px;}
    main {padding: 12px;}
    .row {flex-direction: column;gap: 0;}
    .row > label {min-width: 100%;}
  }
</style>
</head>
<body>
<main>
  <h1>AI Prompt Generator for Web Forms</h1>
  <p class="muted">Fill out details to generate a strict prompt that reproduces a web form filler 1:1 from your reference code (Pastebin / URL).</p>

  <section class="section">
    <h2>New Form Details</h2>
    <label>New Form Title
      <input type="text" id="formTitle" placeholder="e.g., Nomination Form Web Filler">
    </label>
    <label>Goal / Description
      <textarea id="formGoal" rows="3" placeholder="e.g., Create a new web form for nomination, using same styling + signature pad + autosave."></textarea>
    </label>
    <label>Reference Code Location (Pastebin / URL / Full HTML)
      <input type="text" id="referenceCode" placeholder="Paste the raw code or a link (Pastebin raw link recommended)">
      <div class="small-muted">If a link cannot be fetched due to CORS, paste the full HTML here.</div>
    </label>
  </section>

  <section class="section">
    <h2>UI Layout & Fields</h2>
    <div id="sectionsContainer"></div>
    <button id="addSectionBtn" type="button">+ Add New Section</button>
    <div class="small-muted">Each Section can contain multiple fields. Fields map to PDF form fields with IDs.</div>
  </section>
  
  <section class="section">
    <h2>Signature Pad Details</h2>
    <div id="signaturesContainer"></div>
    <button id="addSignatureBtn" type="button">+ Add Signature Field</button>
    <div class="small-muted">Signature blocks include text inputs and dropdowns (e.g., Card Type). The generated prompt enforces signature pad behavior and PDF embedding.</div>
  </section>
  
  <section class="section">
    <h2>PDF Mapping</h2>
    <label>New PDF Filename
      <input type="text" id="pdfFilename" placeholder="e.g., Nomination_Form_fillable.pdf">
    </label>
  </section>

  <section class="section">
    <h2>Final Prompt</h2>
    <div class="row">
      <button id="generatePromptBtn" type="button">Generate Prompt</button>
      <button id="generateSuperPromptBtn" type="button">Generate Super Prompt</button>
      <button id="copyBtn" type="button">Copy</button>
      <button id="clearBtn" type="button" class="secondary">Clear</button>
    </div>
    <textarea id="promptOutput" readonly placeholder="Your generated prompt will appear here."></textarea>
  </section>
</main>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const sectionsContainer = document.getElementById('sectionsContainer');
  const signaturesContainer = document.getElementById('signaturesContainer');
  const output = document.getElementById('promptOutput');

  // escape user text for safe inclusion in prompt
  function escapeText(str) {
    if(!str) return '';
    return String(str).replace(/`/g,"\\`").replace(/"/g,'\\"');
  }

  // -----------------------
  // Section / Field helpers
  // -----------------------
  function addSection(title='') {
    const sectionDiv = document.createElement('div');
    sectionDiv.className = 'form-section';
    sectionDiv.innerHTML = `
      <div class="row">
        <label style="flex:1;">Section Title
          <input type="text" class="sectionTitle" value="${title}" placeholder="e.g., Nominee Details">
        </label>
        <button class="secondary" style="height:38px;align-self:end;" onclick="this.closest('.form-section').remove();">Remove Section</button>
      </div>
      <p>Fields:</p>
      <div class="fieldsContainer"></div>
      <button type="button" class="addFieldBtn">+ Add Field</button>
    `;
    sectionsContainer.appendChild(sectionDiv);
    sectionDiv.querySelector('.addFieldBtn').addEventListener('click', () => addField(sectionDiv.querySelector('.fieldsContainer')));
    return sectionDiv;
  }

  function addField(container) {
    const fieldDiv = document.createElement('div');
    fieldDiv.className = 'field-group';
    fieldDiv.innerHTML = `
      <div class="row">
        <label>Label<input type="text" class="fieldLabel" placeholder="e.g., Nominee's Name"></label>
        <label>HTML ID<input type="text" class="htmlId" placeholder="e.g., nominee_name"></label>
      </div>
      <div class="row">
        <label>Input Type
          <select class="fieldType">
            <option value="text">Text Input</option>
            <option value="email">Email</option>
            <option value="tel">Tel</option>
            <option value="textarea">Textarea</option>
            <option value="select">Select (Dropdown)</option>
            <option value="number">Number</option>
            <option value="radio">Radio (Group)</option>
            <option value="credit-card">Credit Card</option>
          </select>
        </label>
        <label>PDF Field Name<input type="text" class="pdfField" placeholder="e.g., nomineeFullName"></label>
      </div>
      <div class="row">
        <label style="flex:1;">Arrangement / Options<input type="text" class="fieldArrangement" placeholder="e.g., options: Yes, No; in a row with NRIC"></label>
      </div>
      <button type="button" class="field-group-remove" onclick="this.closest('.field-group').remove();">x</button>
    `;
    container.appendChild(fieldDiv);
  }

  // -----------------------
  // Signature helpers
  // -----------------------
  function addSignatureField(title='') {
    const sigDiv = document.createElement('div');
    sigDiv.className = 'field-group';
    sigDiv.innerHTML = `
      <div class="row">
        <label style="flex:1;">Signature Title
          <input type="text" class="sigTitle" value="${title}" placeholder="e.g., Cardholder Signature">
        </label>
        <button class="field-group-remove" onclick="this.closest('.field-group').remove();">x</button>
      </div>

      <div class="row">
        <label style="flex:1;">Text Input Label
          <input type="text" class="sig-text-label" placeholder="e.g., Cardholder Name">
        </label>
        <label style="flex:1;">Field ID
          <input type="text" class="sig-text-id" placeholder="e.g., cardholderName">
        </label>
      </div>

      <div class="row">
        <label style="flex:1;">Dropdown Label
          <input type="text" class="sig-drop-label" placeholder="e.g., Card Type">
        </label>
        <label style="flex:1;">Options (comma separated)
          <input type="text" class="sig-drop-options" placeholder="Credit, Debit" value="Credit, Debit">
        </label>
        <label style="flex:1;">Field ID
          <input type="text" class="sig-drop-id" placeholder="e.g., cardType">
        </label>
      </div>

      <div class="small-muted">The generated prompt will instruct the AI to: include a signature canvas, a Clear button, autosave all fields/signature to localStorage, and embed signature into PDF at correct X/Y/scale.</div>
    `;
    signaturesContainer.appendChild(sigDiv);
  }

  // -----------------------
  // Prompt builder
  // -----------------------
  function buildPrompt(superMode=false) {
    const goal = escapeText(document.getElementById('formGoal').value || '');
    const reference = escapeText(document.getElementById('referenceCode').value || '');
    let prompt = '';

    prompt += `⚠️ STRICT REQUIREMENTS:\n- Replicate 1:1 the HTML, CSS, and JavaScript structure, styling, and runtime behavior from the reference code at: ${reference}\n- Do NOT simplify UI, remove logic, or omit features. The final output must be a full, working single-file HTML+CSS+JS web filler.\n- Required behaviors to copy EXACTLY: dynamic add/remove of multiple items (policies), autosave to localStorage, signature pad popup and embedding, PDF preview and flattening, reset, and field-to-PDF mapping.\n\n`;

    prompt += `**Goal:** ${goal}\n\n`;
    prompt += `**Reference (raw or link):**\n${reference}\n\n`;
    prompt += `**New Form Requirements:**\n`;

    // UI Layout & Fields
    prompt += `\n**UI Layout & Fields:**\n`;
    const sections = document.querySelectorAll('#sectionsContainer .form-section');
    if(sections.length === 0) {
      prompt += '- (No sections defined) -\n';
    } else {
      sections.forEach((sec, si) => {
        const title = escapeText(sec.querySelector('.sectionTitle').value || `Section ${si+1}`);
        prompt += `- Section: ${title}\n`;
        const fields = sec.querySelectorAll('.field-group');
        if(fields.length === 0) {
          prompt += `  - (no fields specified)\n`;
        } else {
          fields.forEach((f) => {
            const label = escapeText(f.querySelector('.fieldLabel').value || '');
            const htmlId = escapeText(f.querySelector('.htmlId').value || '');
            const pdfField = escapeText(f.querySelector('.pdfField').value || '');
            const type = f.querySelector('.fieldType').value || 'text';
            const arrangement = escapeText(f.querySelector('.fieldArrangement').value || '');
            prompt += `  - ${label || '(no label)'} — ${type} input`;
            if(arrangement) prompt += `; arrangement/options: ${arrangement}`;
            if(htmlId) prompt += `; HTML ID: \`${htmlId}\``;
            if(pdfField) prompt += `; maps to PDF field: \`${pdfField}\``;
            prompt += `\n`;
          });
        }
      });
    }

    // Signatures
    prompt += `\n**Signature Pad Details:**\n`;
    const sigNodes = document.querySelectorAll('#signaturesContainer .field-group');
    if(sigNodes.length === 0) {
      prompt += '- (No signature fields defined)\n';
    } else {
      sigNodes.forEach((s, idx) => {
        const title = escapeText(s.querySelector('.sigTitle').value || `Signature ${idx+1}`);
        const textLabel = escapeText(s.querySelector('.sig-text-label').value || '');
        const textId = escapeText(s.querySelector('.sig-text-id').value || '');
        const dropLabel = escapeText(s.querySelector('.sig-drop-label').value || '');
        const dropOptions = escapeText(s.querySelector('.sig-drop-options').value || '');
        const dropId = escapeText(s.querySelector('.sig-drop-id').value || '');

        prompt += `- ${title}:\n`;
        if(textLabel) prompt += `  - Text input: ${textLabel}${textId ? ' (id: '+textId+')' : ''}\n`;
        if(dropLabel) prompt += `  - Dropdown: ${dropLabel}${dropId ? ' (id: '+dropId+')' : ''} — options: ${dropOptions || '[none]'}\n`;
        prompt += `  - Include signature canvas + Clear button.\n`;
        prompt += `  - Autosave all related inputs + signature to localStorage.\n`;
        prompt += `  - Provide a preview and embed the signature into the output PDF at correct X/Y scale (adjustable constants and documented in code).\n`;
      });
    }

    // PDF Mapping
    const pdfFilename = escapeText(document.getElementById('pdfFilename').value || '[Provide PDF filename here]');
    prompt += `\n**PDF Mapping:**\n- PDF File: ${pdfFilename}\n- Ensure each field's HTML ID maps to the PDF field name specified above.\n\n`;

    if(superMode) {
      prompt += `**Extra (Super) Requirement:**\n- Output a single-file runnable HTML page that includes the full implementation: HTML, embedded CSS, and JavaScript. The runnable file should implement exact behavior (UI, autosave, signature, PDF flattening) and include comments where coordinate/X/Y values are set for signature embedding.\n\n`;
    }

    prompt += `\n---\nPlease produce the complete working code (or the strict prompt to generate it) now.\n`;

    return prompt;
  }

  // -----------------------
  // Wire UI buttons
  // -----------------------
  document.getElementById('addSectionBtn').addEventListener('click', () => {
    const s = addSection();
    addField(s.querySelector('.fieldsContainer'));
  });

  document.getElementById('addSignatureBtn').addEventListener('click', () => addSignatureField());

  document.getElementById('generatePromptBtn').addEventListener('click', () => {
    output.value = buildPrompt(false);
    console.log('Prompt generated (strict):', output.value.slice(0,120) + '...');
  });

  document.getElementById('generateSuperPromptBtn').addEventListener('click', () => {
    output.value = buildPrompt(true);
    console.log('Super prompt generated.');
  });

  document.getElementById('copyBtn').addEventListener('click', async () => {
    try {
      const text = output.value;
      if(!text) { alert('Nothing to copy'); return; }
      if(navigator.clipboard && navigator.clipboard.writeText) {
        await navigator.clipboard.writeText(text);
      } else {
        output.select();
        document.execCommand('copy');
      }
      alert('Prompt copied to clipboard');
    } catch (e) {
      console.error('Copy failed', e);
      alert('Copy failed — check console');
    }
  });

  document.getElementById('clearBtn').addEventListener('click', () => {
    output.value = '';
  });

  // -----------------------
  // Init defaults
  // -----------------------
  const firstSection = addSection();
  addField(firstSection.querySelector('.fieldsContainer'));
  addSignatureField();
});
</script>
</body>
</html>
